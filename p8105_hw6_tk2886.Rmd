---
title: "p8105_hw6_tk2886"
author: "Tanvir Khan"
output: github_document
---


```{r}
# Libraries 
library(tidyverse)
library(modelr)

## Set Global Options 
knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6, 
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```


# PROBLEM 1 

```{r}
#Loading Data and cleaning the data
birthwgt_df <- 
  read_csv("./data/birthweight.csv") %>%
  janitor::clean_names()
```


```{r}
#Converted numeric to factor where ever it is appropriate
birthwgt_df <-
  birthwgt_df %>%
  mutate(babysex = recode(babysex,
                          '1' = 'male',
                          '2' = 'female'),
         babysex = factor(babysex, levels = c('male', 'female')),
         frace = recode(frace,
                        '1' = 'White',
                        '2' = 'Black',
                        '3' = 'Asian',
                        '4' = 'Puerto Rican',
                        '8' = 'Other',
                        '9' = 'Unknown'), 
         frace = factor(frace, levels = c('White', 'Black', 'Asian', 'Puerto Rican', 'Other')),
         malform = recode(malform,
                          '0' = 'absent',
                          '1' = 'present'),
         malform = factor(malform, levels = c('absent', 'present')), 
         mrace = recode(mrace,
                        '1' = 'White',
                        '2' = 'Black',
                        '3' = 'Asian',
                        '4' = 'Puerto Rican',
                        '8' = 'Other'), 
         mrace = factor(mrace, levels = c('White', 'Black', 'Asian', 'Puerto Rican', 'Other')))
```
*Based on the assignment guidelines:* babysex, frace, malform, and mrace are the four categorical variables in this dataset in which I believed should be converted to factor because type because it has been indicated in R website that Factor in R is a variable that is used to categorize and store the data, having a limited number of different values. In our case, babysex, frace, malform and mrace have limited number of different values and we may convert to Factor type. 


```{r}
# Check for missing data 
birthwgt_df %>% 
  summarise(across(everything(), ~ sum(is.na(.))))
```
There is *no missing values* in this data set. 


```{r}
# Check how many observation are in this data
n_row = birthwgt_df %>% nrow()
n_col = birthwgt_df %>% ncol()
```
There is *`r n_row`* rows and *`r n_col`* columns in this birthweight dataset. 


# My Proposed Regression Model
```{r}
birthweight_model <- lm(bwt ~ fincome + mrace + ppbmi + smoken + momage + bhead + blength, data = birthwgt_df)
```

```{r}
#obtaining a quick summary of the model and for cleaning up the coefficient table using broom

birthweight_model %>%
  broom::tidy() %>%
  select(term, estimate, p.value) %>% 
  knitr::kable(digits = 6)
```



